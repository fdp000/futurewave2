<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Classifica Olimpiadi AI - FutureWave</title> 
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700;900&display=swap" rel="stylesheet">

    <style>
        .leaderboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap; 
        }

        .leaderboard-filters {
            display: flex; /* Allinea i bottoni */
            flex-wrap: wrap; /* Permette ai bottoni di andare a capo */
            gap: 10px; /* Spazio tra i bottoni */
            position: relative;
            /* Spazio SOTTO i filtri per far apparire la bandiera */
            padding-bottom: 50px; 
            align-items: center;
        }

        /* Wrapper per ogni bottone, necessario per posizionare la bandiera sotto */
        .filter-btn-wrapper {
            position: relative; /* Diventa l'ancora per la bandiera */
            display: inline-block;
        }
        
        /* La NUOVA bandiera che appare SOTTO il bottone attivo */
        .leaderboard-nation-flag {
            width: 50px; /* Più piccola di 80px */
            height: auto;
            border-radius: 6px; /* Angoli stondati */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            
            /* Posizionamento assoluto relativo al wrapper */
            position: absolute;
            bottom: -45px; /* Spazio dal bottone */
            left: 50%; /* Centrata */
            
            /* Animazione */
            opacity: 0;
            transform: translateX(-50%) translateY(-10px); /* Nascosta e leggermente su */
            transition: all 0.3s ease;
            pointer-events: none; /* Per non bloccare i click */
        }
        
        .leaderboard-nation-flag.visible {
            opacity: 1;
            transform: translateX(-50%) translateY(0); /* Appare scendendo */
        }

        .inline-flag {
            width: 32px; /* Era 24px, ora più grande */
            height: auto;
            vertical-align: middle;
            border-radius: 4px; /* Angoli stondati */
        }

        .leaderboard-table th.col-flag,
        .leaderboard-table td.col-flag {
            width: 50px; /* Spazio per la nuova bandiera da 32px */
        }
        .leaderboard-table.nation-view th.col-flag,
        .leaderboard-table.nation-view td.col-flag,
        .leaderboard-table.nation-view th.col-nation,
        .leaderboard-table.nation-view td.col-nation {
            display: none;
        }
    </style>

</head>
<body>

    <header>
        <div class="container">
            <a href="index.html" class="logo">
                <svg width="40" height="40" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M20 50C20 38.9543 28.9543 30 40 30C51.0457 30 60 38.9543 60 50C60 61.0457 51.0457 70 40 70" stroke="var(--color-primary)" stroke-width="10" stroke-linecap="round"/>
                    <path d="M40 50C40 38.9543 48.9543 30 60 30C71.0457 30 80 38.9543 80 50C80 61.0457 71.0457 70 60 70" stroke="var(--color-secondary)" stroke-width="10" stroke-linecap="round" opacity="0.7"/>
                </svg>
                <span class="logo-text">FutureWave</span>
            </a>
            <nav>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="chi-siamo.html">Chi Siamo</a></li>
                    <li><a href="formazione-ai.html">Formazione AI</a></li>
                    <li class="nav-active"><a href="classifica.html">Classifica</a></li> 
                    <li><a href="gestisci-team.html">Gestisci Team</a></li> 
                    <li><a href="portale-manager.html">Manager</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="main-page-content">

        <section id="leaderboard-hero" class="fade-in-section is-visible" style="text-align: center;">
            <div class="container">
                <h1 class="animate-on-visible">Classifica Olimpiadi AI</h1>
                <p class="section-subtitle animate-on-visible delay-1" style="margin-top: 1rem;">Segui l'andamento dei team in tempo reale.</p>
            </div>
        </section>

        <div class="container">
            
            <section class="fade-in-section">
                
                <div class="leaderboard-header animate-on-visible">
                    <div class="leaderboard-filters">
                        
                        <span><strong>Filtra:</strong></span>
                        
                        <div class="filter-btn-wrapper">
                            <button class="filter-btn active" data-nation="all">Tutte</button>
                        </div>
                        <div class="filter-btn-wrapper">
                            <button class="filter-btn" data-nation="it">Italia</button>
                        </div>
                        <div class="filter-btn-wrapper">
                            <button class="filter-btn" data-nation="fr">Francia</button>
                        </div>
                        <div class="filter-btn-wrapper">
                            <button class="filter-btn" data-nation="de">Germania</button>
                        </div>
                        <div class="filter-btn-wrapper">
                            <button class="filter-btn" data-nation="es">Spagna</button>
                        </div>
                        <div class="filter-btn-wrapper">
                            <button class="filter-btn" data-nation="gb">Regno Unito</button>
                        </div>
                        <div class="filter-btn-wrapper">
                            <button class="filter-btn" data-nation="us">Stati Uniti</button>
                        </div>
                        <div class="filter-btn-wrapper">
                            <button class="filter-btn" data-nation="in">India</button>
                        </div>
                    </div>
                </div>

                <div class="animate-on-visible delay-1">
                    <table class="leaderboard-table" id="leaderboard-table">
                        <thead>
                            <tr>
                                <th class="col-flag"></th> 
                                <th>Pos.</th>
                                <th>Team</th>
                                <th class="col-nation">Nazione</th>
                                <th>Challenge Completate</th>
                                <th>Punteggio Totale</th>
                            </tr>
                        </thead>
                        <tbody id="leaderboard-body">
                            </tbody>
                    </table>
                </div>
            </section>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 FutureWave. Tutti i diritti riservati.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // === 1. DATI ===
            const nationFlagUrls = {
                 'it': 'https://flagcdn.com/w80/it.png',
                 'fr': 'https://flagcdn.com/w80/fr.png',
                 'de': 'https://flagcdn.com/w80/de.png',
                 'es': 'https://flagcdn.com/w80/es.png',
                 'gb': 'https://flagcdn.com/w80/gb.png',
                 'us': 'https://flagcdn.com/w80/us.png',
                 'in': 'https://flagcdn.com/w80/in.png'
            };
            const smallFlagUrls = {
                 'it': 'https://flagcdn.com/w40/it.png',
                 'fr': 'https://flagcdn.com/w40/fr.png',
                 'de': 'https://flagcdn.com/w40/de.png',
                 'es': 'https://flagcdn.com/w40/es.png',
                 'gb': 'https://flagcdn.com/w40/gb.png',
                 'us': 'https://flagcdn.com/w40/us.png',
                 'in': 'https://flagcdn.com/w40/in.png'
            };

            const allTeamsData = [
                { name: 'AI Innovators', nation: 'Italia', nationCode: 'it', challenges: 3, score: 285 },
                { name: 'Les Champs-Élysées AI', nation: 'Francia', nationCode: 'fr', challenges: 3, score: 270 },
                { name: 'Berlin Bots', nation: 'Germania', nationCode: 'de', challenges: 2, score: 210 },
                { name: 'Future Coders', nation: 'Italia', nationCode: 'it', challenges: 2, score: 195 },
                { name: 'Madrid AI', nation: 'Spagna', nationCode: 'es', challenges: 2, score: 190 },
                { name: 'London Signals', nation: 'Regno Unito', nationCode: 'gb', challenges: 1, score: 115 },
                { name: 'Paris AI Crew', nation: 'Francia', nationCode: 'fr', challenges: 1, score: 110 },
                { name: 'NY Quant', nation: 'Stati Uniti', nationCode: 'us', challenges: 1, score: 105 },
                { name: 'Oktoberfest Coders', nation: 'Germania', nationCode: 'de', challenges: 1, score: 95 },
                { name: 'Bangalore Tech', nation: 'India', nationCode: 'in', challenges: 1, score: 90 },
                { name: 'Roma Data', nation: 'Italia', nationCode: 'it', challenges: 1, score: 85 }
            ];

            // === 2. ELEMENTI DOM ===
            const filterButtons = document.querySelectorAll('.filter-btn');
            const tableBody = document.getElementById('leaderboard-body');
            const leaderboardTable = document.getElementById('leaderboard-table');
            const sections = document.querySelectorAll('.fade-in-section');

            // === 3. FUNZIONE DI RENDER ===
            function renderTable(selectedNation) {
                
                document.querySelectorAll('.leaderboard-nation-flag').forEach(flag => flag.remove());

                if (selectedNation !== 'all') {
                    const activeButton = document.querySelector(`.filter-btn[data-nation="${selectedNation}"]`);
                    if (activeButton) {
                        const wrapper = activeButton.parentElement; 
                        
                        const flagImg = document.createElement('img');
                        flagImg.src = nationFlagUrls[selectedNation];
                        flagImg.alt = `Bandiera ${selectedNation.toUpperCase()}`;
                        flagImg.className = 'leaderboard-nation-flag'; 
                        wrapper.appendChild(flagImg);

                        setTimeout(() => {
                            flagImg.classList.add('visible');
                        }, 10); 
                    }
                }

                let filteredTeams = [];
                if (selectedNation === 'all') {
                    filteredTeams = [...allTeamsData];
                    leaderboardTable.classList.remove('nation-view');
                } else {
                    filteredTeams = allTeamsData.filter(team => team.nationCode === selectedNation);
                    leaderboardTable.classList.add('nation-view');
                }

                filteredTeams.sort((a, b) => b.score - a.score);

                tableBody.innerHTML = '';

                filteredTeams.forEach((team, index) => {
                    const pos = index + 1;
                    const flagImg = `<img src="${smallFlagUrls[team.nationCode]}" alt="${team.nation}" class="inline-flag">`;
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td class="col-flag">${flagImg}</td>
                        <td class="col-pos"><strong>${pos}</strong></td>
                        <td class="col-team">${team.name}</td>
                        <td class="col-nation">${team.nation}</td>
                        <td class="col-challenges">${team.challenges}</td>
                        <td class="col-score">${team.score}</td>
                    `;
                    tableBody.appendChild(row);
                });
            }

            // === 4. LISTENER E AVVIO ===
            
            filterButtons.forEach(button => {
                button.addEventListener('click', function() {
                    filterButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    
                    const nation = this.getAttribute('data-nation');
                    renderTable(nation);
                });
            });

            renderTable('all');

            // === 5. LOGICA ANIMAZIONI (invariata) ===
            sections[0]?.classList.add('is-visible'); 
            const animatedChildrenInit = sections[0]?.querySelectorAll('.animate-on-visible');
            animatedChildrenInit?.forEach(child => child.classList.add('is-visible'));

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                         const animatedChildren = entry.target.querySelectorAll('.animate-on-visible');
                        animatedChildren.forEach(child => child.classList.add('is-visible'));
                        observer.unobserve(entry.target);
                    }
                });
            }, { rootMargin: '0px 0px -100px 0px' });

            sections.forEach(section => {
                if (!section.classList.contains('is-visible')) {
                    observer.observe(section);
                } 
            });
        });
    </script>

</body>
</html>